{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "web2fb Configuration",
  "description": "Configuration schema for web2fb - Web to Framebuffer Renderer. Supports both YAML (.yaml/.yml) and JSON (.json) formats.",
  "type": "object",
  "required": ["display"],
  "properties": {
    "name": {
      "type": "string",
      "description": "Human-readable name for this configuration"
    },
    "description": {
      "type": "string",
      "description": "Description of what this configuration does"
    },
    "display": {
      "type": "object",
      "required": ["url"],
      "properties": {
        "url": {
          "type": "string",
          "description": "URL of the webpage to render",
          "format": "uri"
        },
        "width": {
          "type": "integer",
          "description": "Display width in pixels",
          "default": 1920,
          "minimum": 1
        },
        "height": {
          "type": "integer",
          "description": "Display height in pixels",
          "default": 1080,
          "minimum": 1
        },
        "framebufferDevice": {
          "type": "string",
          "description": "Path to framebuffer device",
          "default": "/dev/fb0"
        }
      }
    },
    "browser": {
      "type": "object",
      "properties": {
        "mode": {
          "type": "string",
          "enum": ["local", "remote"],
          "description": "Screenshot mode: 'local' uses Puppeteer on Pi, 'remote' uses cloud service (Cloudflare Worker)",
          "default": "local"
        },
        "remoteScreenshotUrl": {
          "type": "string",
          "description": "URL to remote screenshot service (Cloudflare Worker). Required when mode is 'remote'",
          "format": "uri"
        },
        "remoteApiKey": {
          "type": "string",
          "description": "API key for authenticating with remote screenshot service"
        },
        "remoteTimeout": {
          "type": "integer",
          "description": "Timeout for remote screenshot requests in milliseconds",
          "default": 60000,
          "minimum": 5000
        },
        "userAgent": {
          "type": "string",
          "description": "Custom user agent string"
        }
      }
    },
    "overlays": {
      "type": "array",
      "description": "Elements to hide and re-render locally for performance",
      "items": {
        "type": "object",
        "required": ["name", "type", "selector", "region", "style"],
        "properties": {
          "name": {
            "type": "string",
            "description": "Unique identifier for this overlay"
          },
          "type": {
            "type": "string",
            "enum": ["clock", "date", "text", "custom"],
            "description": "Type of overlay renderer to use"
          },
          "selector": {
            "type": "string",
            "description": "CSS selector to find the element to replace"
          },
          "enabled": {
            "type": "boolean",
            "description": "Whether this overlay is active",
            "default": true
          },
          "updateInterval": {
            "type": "integer",
            "description": "How often to update this overlay in milliseconds",
            "default": 1000,
            "minimum": 100
          },
          "format": {
            "type": "object",
            "description": "Formatting options (varies by overlay type)"
          },
          "text": {
            "type": "string",
            "description": "Static text content (for type: 'text')"
          },
          "comment": {
            "type": "string",
            "description": "Optional comment explaining this overlay"
          },
          "region": {
            "type": "object",
            "description": "Overlay region (use tools/detect-overlays.js to generate)",
            "required": ["x", "y", "width", "height"],
            "properties": {
              "x": {"type": "integer"},
              "y": {"type": "integer"},
              "width": {"type": "integer"},
              "height": {"type": "integer"}
            }
          },
          "style": {
            "type": "object",
            "description": "Overlay style (use tools/detect-overlays.js to generate)",
            "required": ["fontSize", "fontFamily", "color"],
            "properties": {
              "fontSize": {"type": "integer"},
              "fontFamily": {"type": "string"},
              "color": {"type": "string"},
              "fontWeight": {"type": "string"},
              "textAlign": {"type": "string"},
              "letterSpacing": {"type": "string"}
            }
          }
        }
      }
    },
    "changeDetection": {
      "type": "boolean",
      "description": "Enable automatic change detection (watches for image/background changes). Only supported with local browser mode.",
      "default": true
    },
    "splashScreen": {
      "type": "string",
      "description": "Path to splash screen image to show during startup. Performance monitoring can be enabled with DEBUG=1 environment variable."
    }
  }
}
